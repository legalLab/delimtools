<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Confidence Intervals for Species Delimitations Methods — confidence_intervals • delimtools</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Confidence Intervals for Species Delimitations Methods — confidence_intervals"><meta name="description" content="These functions compute confidence intervals for various species delimitation
methods, including GMYC, bGMYC, Local Minima, and mPTP."><meta property="og:description" content="These functions compute confidence intervals for various species delimitation
methods, including GMYC, bGMYC, Local Minima, and mPTP."><meta property="og:image" content="https://legallab.github.io/delimtools/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">delimtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/install.html">Installing Species Delimitation Softwares</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/legalLab/delimtools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Confidence Intervals for Species Delimitations Methods</h1>
      <small class="dont-index">Source: <a href="https://github.com/legalLab/delimtools/blob/main/R/confidence_intervals.R" class="external-link"><code>R/confidence_intervals.R</code></a></small>
      <div class="d-none name"><code>confidence_intervals.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions compute confidence intervals for various species delimitation
methods, including GMYC, bGMYC, Local Minima, and mPTP.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gmyc_ci</span><span class="op">(</span><span class="va">tr</span>, <span class="va">posterior</span>, method <span class="op">=</span> <span class="st">"single"</span>, interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">bgmyc_ci</span><span class="op">(</span></span>
<span>  <span class="va">tr</span>,</span>
<span>  <span class="va">posterior</span>,</span>
<span>  ppcutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  <span class="va">mcmc</span>,</span>
<span>  <span class="va">burnin</span>,</span>
<span>  <span class="va">thinning</span>,</span>
<span>  py1 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  py2 <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  pc1 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  pc2 <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  t1 <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  t2 <span class="op">=</span> <span class="fl">51</span>,</span>
<span>  scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">10</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">50</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">locmin_ci</span><span class="op">(</span><span class="va">dna</span>, block <span class="op">=</span> <span class="fl">1</span>, reps <span class="op">=</span> <span class="fl">100</span>, threshold <span class="op">=</span> <span class="fl">0.01</span>, haps <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">mptp_ci</span><span class="op">(</span></span>
<span>  <span class="va">infile</span>,</span>
<span>  <span class="va">bootstraps</span>,</span>
<span>  exe <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  outfolder <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"multi"</span>, <span class="st">"single"</span><span class="op">)</span>,</span>
<span>  minbrlen <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  webserver <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tr">tr<a class="anchor" aria-label="anchor" href="#arg-tr"></a></dt>
<dd><p>An ultrametric, dichotomous tree object in ape format.</p></dd>


<dt id="arg-posterior">posterior<a class="anchor" aria-label="anchor" href="#arg-posterior"></a></dt>
<dd><p>Trees from posterior. An object of class <a href="https://rdrr.io/pkg/ape/man/multiphylo.html" class="external-link">multiphylo</a>.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Method of analysis, either "single" for single-threshold version or "multiple" for multiple-threshold version.</p></dd>


<dt id="arg-interval">interval<a class="anchor" aria-label="anchor" href="#arg-interval"></a></dt>
<dd><p>Upper and lower limit of estimation of scaling parameters, e.g. c(0,10)</p></dd>


<dt id="arg-ppcutoff">ppcutoff<a class="anchor" aria-label="anchor" href="#arg-ppcutoff"></a></dt>
<dd><p>Posterior probability threshold for clustering samples into species partitions.
See <a href="https://rdrr.io/pkg/bGMYC/man/bgmyc.point.html" class="external-link">bgmyc.point</a> for details. Default to 0.05.</p></dd>


<dt id="arg-mcmc">mcmc<a class="anchor" aria-label="anchor" href="#arg-mcmc"></a></dt>
<dd><p>number of samples to take from the Markov Chain</p></dd>


<dt id="arg-burnin">burnin<a class="anchor" aria-label="anchor" href="#arg-burnin"></a></dt>
<dd><p>the number of samples to discard as burn-in</p></dd>


<dt id="arg-thinning">thinning<a class="anchor" aria-label="anchor" href="#arg-thinning"></a></dt>
<dd><p>the interval at which samples are retained from the Markov Chain</p></dd>


<dt id="arg-py-">py1<a class="anchor" aria-label="anchor" href="#arg-py-"></a></dt>
<dd><p>governs the prior on the Yule (speciation) rate change parameter. using the default prior distribution, this is the lower bound of a uniform distribution. this can be the most influential prior of the three. rate change is parameterized as n^py where n is the number of lineages in a waiting interval (see Pons et al. 2006). if there are 50 sequences in an analysis and the Yule rate change parameter is 2, this allows for a potential 50-fold increase in speciation rate. this unrealistic parameter value can cause the threshold between Yule and Coalescent process to be difficult to distinguish. are more reasonable upper bound for the prior would probably be less than 1.5 (a potential 7-fold increase). Or you could modify the prior function to use a different distribution entirely.</p></dd>


<dt id="arg-py-">py2<a class="anchor" aria-label="anchor" href="#arg-py-"></a></dt>
<dd><p>governs the prior on the Yule rate change parameter. using the default prior distribution, this is the upper bound of a uniform distribution.</p></dd>


<dt id="arg-pc-">pc1<a class="anchor" aria-label="anchor" href="#arg-pc-"></a></dt>
<dd><p>governs the prior on the coalescent rate change parameter. using the default prior distribution, this is the lower bound of a uniform distribution. rate change is parameterized as (n(n-1))^pc where n is the number of lineages in a waiting interval (see Pons et al. 2006). In principle pc can be interpreted as change in effective population size (pc&lt;1 decline, pc&gt;1 growth) but because identical haplotypes must be excluded from this analysis an accurate biological interpretation is not possible.</p></dd>


<dt id="arg-pc-">pc2<a class="anchor" aria-label="anchor" href="#arg-pc-"></a></dt>
<dd><p>governs the prior on the coalescent rate change parameter. using the default prior distribution, this is the upper bound of a uniform distribution.</p></dd>


<dt id="arg-t-">t1<a class="anchor" aria-label="anchor" href="#arg-t-"></a></dt>
<dd><p>governs the prior on the threshold parameter. the lower bound of a uniform distribution. the bounds of this uniform distribution should not be below 1 or greater than the number of unique haplotypes in the analysis.</p></dd>


<dt id="arg-t-">t2<a class="anchor" aria-label="anchor" href="#arg-t-"></a></dt>
<dd><p>governs the prior on the threshold parameter. the upper bound of a uniform distribution</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>a vector of scale parameters governing the proposal distributions for the markov chain. the first to are the Yule and coalescent rate change parameters. increasing them makes the proposals more conservative. the third is the threshold parameter. increasing it makes the proposals more liberal.</p></dd>


<dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>a vector of starting parameters in the same order as the scale parameters, py, pc, t. t may need to be set so that it is not impossible given the dataset.</p></dd>


<dt id="arg-dna">dna<a class="anchor" aria-label="anchor" href="#arg-dna"></a></dt>
<dd><p>an object of class <a href="https://rdrr.io/pkg/ape/man/DNAbin.html" class="external-link">DNAbin</a>.</p></dd>


<dt id="arg-block">block<a class="anchor" aria-label="anchor" href="#arg-block"></a></dt>
<dd><p>integer. Number of columns to be resampled together. Default to 1.</p></dd>


<dt id="arg-reps">reps<a class="anchor" aria-label="anchor" href="#arg-reps"></a></dt>
<dd><p>Number of bootstrap replicates. Default to 100.</p></dd>


<dt id="arg-threshold">threshold<a class="anchor" aria-label="anchor" href="#arg-threshold"></a></dt>
<dd><p>Distance cutoff for clustering. Default of 0.01. See
<a href="https://rdrr.io/pkg/spider/man/localMinima.html" class="external-link">localMinima</a> for details.</p></dd>


<dt id="arg-haps">haps<a class="anchor" aria-label="anchor" href="#arg-haps"></a></dt>
<dd><p>Optional. A vector of haplotypes to keep into the <a href="https://tibble.tidyverse.org/reference/tbl_df-class.html" class="external-link">tbl_df</a>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments to be passed to <a href="https://rdrr.io/pkg/ape/man/dist.dna.html" class="external-link">dist.dna</a>.</p></dd>


<dt id="arg-infile">infile<a class="anchor" aria-label="anchor" href="#arg-infile"></a></dt>
<dd><p>Path to tree file in Newick format. Should be dichotomous and rooted.</p></dd>


<dt id="arg-bootstraps">bootstraps<a class="anchor" aria-label="anchor" href="#arg-bootstraps"></a></dt>
<dd><p>Bootstrap trees. An object of class <a href="https://rdrr.io/pkg/ape/man/multiphylo.html" class="external-link">multiphylo</a>.</p></dd>


<dt id="arg-exe">exe<a class="anchor" aria-label="anchor" href="#arg-exe"></a></dt>
<dd><p>Path to an mPTP executable.</p></dd>


<dt id="arg-outfolder">outfolder<a class="anchor" aria-label="anchor" href="#arg-outfolder"></a></dt>
<dd><p>Path to output folder. Default to NULL. If not specified, a temporary location is used.</p></dd>


<dt id="arg-minbrlen">minbrlen<a class="anchor" aria-label="anchor" href="#arg-minbrlen"></a></dt>
<dd><p>Numeric. Branch lengths smaller or equal to the value provided
are ignored from computations. Default to 0.0001. Use <a href="min_brlen.html">min_brlen</a>for fine tuning.</p></dd>


<dt id="arg-webserver">webserver<a class="anchor" aria-label="anchor" href="#arg-webserver"></a></dt>
<dd><p>A .txt file containing mPTP results obtained from a webserver. Default to NULL.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A vector containing the number of species partitions in <code>tr</code>, <code>dna</code> or <code>infile</code> followed by
the number of partitions in <code>posterior</code>, <code>reps</code> or <code>bootstraps</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Both <code>gmyc_ci</code> and <code>bgmyc_ci</code> can take a very long time to proccess, depending on how many
posterior trees are provided. As an alternative, these analyses can be sped up significantly
by running in parallel using <a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Pedro S. Bittencourt, Rupert A. Collins.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># gmyc confidence intervals</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compute values using multisession mode</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="st">"multisession"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">gmyc_res</span> <span class="op">&lt;-</span> <span class="fu">gmyc_ci</span><span class="op">(</span><span class="va">geophagus_beast</span>, <span class="va">geophagus_posterior</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># reset future parameters</span></span></span>
<span class="r-in"><span>  <span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="st">"sequential"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot distribution</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">gmyc_res</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># tabulate</span></span></span>
<span class="r-in"><span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"gmyc"</span>,</span></span>
<span class="r-in"><span>  point_estimate <span class="op">=</span> <span class="va">gmyc_res</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  CI_95 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">gmyc_res</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_flatten.html" class="external-link">str_flatten</a></span><span class="op">(</span>collapse <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  CI_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">gmyc_res</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  CI_median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">gmyc_res</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pedro Bittencourt, Rupert Collins, Tomas Hrbek.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

