<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Helper Functions for Species Delimitation Analysis • delimtools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Helper Functions for Species Delimitation Analysis">
<meta name="description" content="Helpers functions to process, analyse, and visualize the output of single locus species delimitation methods. For full functionality, please install suggested software at &lt;https://legallab.github.io/delimtools/articles/install.html&gt;.">
<meta property="og:description" content="Helpers functions to process, analyse, and visualize the output of single locus species delimitation methods. For full functionality, please install suggested software at &lt;https://legallab.github.io/delimtools/articles/install.html&gt;.">
<meta property="og:image" content="/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">delimtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/delimtools.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/install.html">Installing Species Delimitation Softwares</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/legalLab/delimtools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.svg" class="logo" alt=""><h1 id="delimtools-">delimtools <a class="anchor" aria-label="anchor" href="#delimtools-"></a>
</h1>
</div>
<!-- badges: start -->

<div class="section level2">
<h2 id="important">IMPORTANT<a class="anchor" aria-label="anchor" href="#important"></a>
</h2>
<p>This software is under active development, and as such cannot be assumed to be free of bugs or poor functionality. Always inspect results carefully. If you find a problem, please report it with as much detail as possible in <a href="https://github.com/LegalLab/delimtools/issues" class="external-link">Issues</a>. Unfortunately in it’s current form, some of the functions (<code><a href="reference/abgd_tbl.html">abgd_tbl()</a></code>, <code><a href="reference/asap_tbl.html">asap_tbl()</a></code> and <code><a href="reference/mptp_tbl.html">mptp_tbl()</a></code>) will not work on Windows operating systems, only on Unix (MacOS, Linux). This is because third party binaries (executable programs) are required. We are working to implement importing results from the webservers that are commonly used to run these analyses. There are also difficulties with installing R required package dependancies to run <code><a href="reference/gmyc_tbl.html">gmyc_tbl()</a></code> and <code><a href="reference/bgmyc_tbl.html">bgmyc_tbl()</a></code> because these are no longer under development and available on CRAN, and must be installed from archived sources. Please refer to <a href="https://github.com/boopsboops/delimtools-testing/blob/main/scripts/install.md" class="external-link">github.com/boopsboops/delimtools-testing</a> for instructions on how to install.</p>
</div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The official GitHub repository for the R package <code>delimtools</code> (Bittencourt et al., in prep.).</p>
<p><code>delimtools</code> provides helper functions for the analysis of single-locus species delimitation methods such as GMYC (<a href="https://doi.org/10.1093/sysbio/syp027" class="external-link">Monaghan et al., 2009</a>), bGMYC (<a href="https://doi.org/10.1186/1471-2148-12-196" class="external-link">Reid &amp; Carstens, 2012</a>), mPTP (<a href="https://doi.org/10.1093/bioinformatics/btx025" class="external-link">Kapli et al., 2017</a>) and ASAP (<a href="https://doi.org/10.1111/1755-0998.13281" class="external-link">Puillandre et al., 2020</a>). These software run multiple different platforms (e.g. R, Unix, webservers), and also do not output their results in a consistent format to allow easy comparison. To address these shortcomings we have developed a suite of functions to standardise and simplify generating single-locus species delimitations.</p>
</div>
<div class="section level2">
<h2 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a>
</h2>
<p>Delimtools mainly depends on the <a href="https://www.tidyverse.org/" class="external-link">tidyverse</a> and <a href="https://github.com/YuLab-SMU/ggtree" class="external-link">ggtree</a> packages. To install these, run the command lines below:</p>
<p>Install <code>tidyverse</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"tidyverse"</span><span class="op">)</span></span></code></pre></div>
<p>Install <code>ggtree</code></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://bioconductor.github.io/BiocManager/" class="external-link">"BiocManager"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="st">"ggtree"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install <code>delimtools</code> you may execute the following commands. We recommend the usage of the latest CRAN release always.</p>
<p>Latest stable version from CRAN</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"delimtools"</span><span class="op">)</span></span></code></pre></div>
<p>Development version from GitHub:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"LegalLab/delimtools"</span><span class="op">)</span></span></code></pre></div>
<p>Or a specific version via renv:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">renv</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/renv/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"LegalLab/delimtools@v0.1.0"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>Here, we will demonstrate a single-locus species delimitation analysis on a <em>Geophagus</em> eartheater cichlid dataset (<a href="https://doi.org/10.7717/peerj.12443" class="external-link">Ximenes et al., 2021</a>) using a variety of methods. For full details please see the GitHub repository accompanying this R package at <a href="https://github.com/boopsboops/delimtools-testing" class="external-link">github.com/boopsboops/delimtools-testing</a>.</p>
<figure><img src="https://raw.githubusercontent.com/boopsboops/delimtools-testing/79d6257c9ae4b7da1047e5ffa9ef1a04b4139dae/assets/geophagus_redhead_tapajos.jpg" alt="Redhead Eartheater Geophagus pyrocephalus"><figcaption aria-hidden="true">
Redhead Eartheater <em>Geophagus pyrocephalus</em>
</figcaption></figure><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/legalLab/delimtools" class="external-link">delimtools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># make tip label table</span></span>
<span><span class="va">tip.tab</span> <span class="op">&lt;-</span> <span class="va">geophagus_info</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">gbAccession</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">geophagus_beast</span><span class="op">@</span><span class="va">phylo</span><span class="op">$</span><span class="va">tip.label</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>labs<span class="op">=</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"{gbAccession} | {scientificName}"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">gbAccession</span>, <span class="va">labs</span>, <span class="va">scientificName</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get cols</span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/delim_brewer.html">delim_brewer</a></span><span class="op">(</span>delim<span class="op">=</span> <span class="va">geophagus_delims</span>, package<span class="op">=</span><span class="st">"randomcoloR"</span>, seed<span class="op">=</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot</span></span>
<span><span class="fu"><a href="reference/delim_autoplot.html">delim_autoplot</a></span><span class="op">(</span>delim <span class="op">=</span> <span class="va">geophagus_delims</span>, </span>
<span>               tr <span class="op">=</span> <span class="va">geophagus_beast</span>, </span>
<span>               consensus <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               n_match <span class="op">=</span> <span class="fl">4</span>,</span>
<span>               delim_order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"asap"</span>,<span class="st">"abgd"</span>,<span class="st">"locmin"</span>,<span class="st">"gmyc"</span>,<span class="st">"bgmyc"</span>,<span class="st">"ptp"</span>, <span class="st">"mptp"</span>,<span class="st">"morph"</span><span class="op">)</span>,</span>
<span>               tbl_labs <span class="op">=</span> <span class="va">tip.tab</span>, </span>
<span>               col_vec <span class="op">=</span> <span class="va">cols</span>,</span>
<span>               hexpand <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>               widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example-1.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="current-contributors">Current contributors<a class="anchor" aria-label="anchor" href="#current-contributors"></a>
</h2>
<ul>
<li><a href="https://github.com/pedrosenna" class="external-link">Pedro S. Bittencourt</a></li>
<li><a href="https://github.com/boopsboops" class="external-link">Rupert A. Collins</a></li>
<li><a href="https://github.com/killidude" class="external-link">Tomas Hrbek</a></li>
</ul>
</div>
<div class="section level2">
<h2 id="meta">Meta<a class="anchor" aria-label="anchor" href="#meta"></a>
</h2>
<ul>
<li>Please <a href="https://github.com/legalLab/delimtools/issues" class="external-link">report here any issues or bugs or suggestions</a>.</li>
<li>License: MIT.</li>
<li>Get citation information for <code>delimtools</code> in R by running <code>citation(package='delimtools')</code>.</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=delimtools" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/legalLab/delimtools/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/legalLab/delimtools/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing delimtools</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Pedro Bittencourt <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0002-4074-3541" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Rupert Collins <br><small class="roles"> Author, contributor, copyright holder </small> <a href="https://orcid.org/0000-0002-9135-1169" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Tomas Hrbek <br><small class="roles"> Author, contributor </small> <a href="https://orcid.org/0000-0003-3239-7068" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=delimtools" class="external-link"><img src="https://www.r-pkg.org/badges/version/delimtools" alt="CRAN status"></a></li>
<li><a href="https://cran.r-project.org/package=delimtools" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/delimtools"></a></li>
<li><a href="https://github.com/legalLab/delimtools/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/legalLab/delimtools/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pedro Bittencourt, Rupert Collins, Tomas Hrbek.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
